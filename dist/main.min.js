(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/config.js":[function(require,module,exports){
/**
 * Created by saurabhk on 10/07/16.
 */
module.exports = {
    graphicPadding: 50,
    gameBoundaryWidth:10
};
},{}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/entities/player.js":[function(require,module,exports){
var Player = function (game, x, y) {
    Phaser.Sprite.call(this, game, x, y, 'testsprite');
    game.add.existing(this);
};

Player.prototype = Object.create(Phaser.Sprite.prototype);
Player.prototype.constructor = Player;

/**
 * Automatically called by World.update
 */
Player.prototype.update = function () {
};

module.exports = Player;

},{}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(800, 600, Phaser.AUTO, 'tictactoe-game');

window.Utils = require('./utils/utils');
require('./utils/prototype');
window.playerState = {
    currentLevel: 'Game'
};
window.globalUser = {};
globalUser.settings = {
    grids:4
};

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));
game.state.add('GameOver', require('./states/gameOver'));

game.state.start('Boot');

},{"./states/boot":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/boot.js","./states/game":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/game.js","./states/gameOver":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/gameOver.js","./states/menu":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/menu.js","./states/preloader":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/preloader.js","./states/splash":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/splash.js","./utils/prototype":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/utils/prototype.js","./utils/utils":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/utils/utils.js"}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/boot.js":[function(require,module,exports){
var Boot = function () {
};

module.exports = Boot;

Boot.prototype = {

    preload: function () {
        this.load.image('preloader', 'assets/preloader.gif');
    },

    create: function () {
        this.game.input.maxPointers = 1;
        this.game.stage.backgroundColor = "#ffffff";
        if (this.game.device.desktop) {
            this.game.stage.scale.pageAlignHorizontally = true;
        } else {
            this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
            this.game.scale.minWidth = 480;
            this.game.scale.minHeight = 260;
            this.game.scale.maxWidth = 640;
            this.game.scale.maxHeight = 480;
            //this.game.scale.forceLandscape = true;
            this.game.scale.pageAlignHorizontally = true;
            this.game.scale.updateLayout(true);
        }

        this.game.state.start('Preloader');
    }
};

},{}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/game.js":[function(require,module,exports){
var Player = require('../entities/player');
var config = require('../config');
var utils = require('../utils/utils');

var Game = function () {
    this.testentity = null;
    this.graphics = null;
    this.sectionSize = null;
    this.turn = true;
    this.boardState = [];
};

module.exports = Game;

Game.prototype = {

    create: function () {
        var i,j;
        var graphics = this.game.add.graphics(config.graphicPadding, config.graphicPadding);
        this.graphics = graphics;

        // set a fill and line style
        graphics.lineStyle(config.gameBoundaryWidth, 0xdddddd);
        var gridDetails = utils.gridSize(this.game);

        // Vertical lines
        for (i = 1; i < globalUser.settings.grids; i++) {
            graphics.moveTo(i * gridDetails[0] + (i-1) * config.gameBoundaryWidth,0);
            graphics.lineTo(i * gridDetails[0] + (i-1) * config.gameBoundaryWidth, gridDetails[1]);
        }

        // Horizontal lines
        for (j = 1; j < globalUser.settings.grids; j++) {
            graphics.moveTo(0, j * gridDetails[0] + (j-1) * config.gameBoundaryWidth);
            graphics.lineTo(gridDetails[1], j * gridDetails[0] + (j-1) * config.gameBoundaryWidth);
        }
        this.sectionSize = gridDetails[1]/globalUser.settings.grids;
        this.input.onDown.add(this.addPlayingPiece, this);

        // Initialize board state with all 0 by default
        for(i = 0; i < globalUser.settings.grids; i++) {
            for(j = 0; j < globalUser.settings.grids; j++) {
                if (this.boardState[i]) {
                    this.boardState[i][j] = 0
                } else {
                    this.boardState[i] = [];
                    this.boardState[i][j] = 0
                }
            }
        }
    },

    update: function () {
    },

    onInputDown: function () {
        this.game.state.start('Menu');
    },

    addPlayingPiece: function() {
        var xCordinate;
        var yCordinate;
        var sectionSize = this.sectionSize;
        var mouse = this.input.position;
        mouse.x = mouse.x - config.graphicPadding;
        mouse.y = mouse.y - config.graphicPadding;

        for (var x = 0;x < globalUser.settings.grids;x++) {
            for (var y = 0;y < globalUser.settings.grids;y++) {
                xCordinate = x * sectionSize;
                yCordinate = y * sectionSize;

                if (
                    mouse.x >= xCordinate && mouse.x <= xCordinate + sectionSize &&
                    mouse.y >= yCordinate && mouse.y <= yCordinate + sectionSize
                    ) {

                    //clearPlayingArea(xCordinate, yCordinate);
                    globalUser.turn = [y,x];
                    if(this.boardState[y][x] == 0) {
                        if (this.turn) {
                            this.drawX(xCordinate, yCordinate);
                            this.boardState[y][x] = "X";
                        } else {
                            this.drawO(xCordinate, yCordinate);
                            this.boardState[y][x] = "O";
                        }
                        this.turn = !this.turn;
                        if(this.isStateTerminal()) {
                            this.game.state.start("GameOver");
                        }
                    }

                }
            }
        }
    },

    drawO: function(x, y) {
        var sectionSize = this.sectionSize;
        var graphics = this.graphics;
        var halfSectionSize = (0.5 * sectionSize);
        var centerX = x + halfSectionSize;
        var centerY = y + halfSectionSize;
        var diameter = sectionSize * 0.4;
            graphics.lineStyle(10, 0x01bBC2);
            graphics.drawCircle(centerX, centerY, diameter);

    },

    drawX: function(x,y) {
        var graphics = this.graphics;
        var sectionSize = this.sectionSize;
        graphics.lineStyle(10, 0xf1be32);
        var offset = sectionSize * 0.3;
        graphics.moveTo(x + offset, y + offset);
        graphics.lineTo(x + sectionSize - offset, y + sectionSize - offset);

        graphics.moveTo(x + offset, y + sectionSize - offset);
        graphics.lineTo(x + sectionSize - offset, y + offset);
    },

    isStateTerminal: function() {
        var x, y;
        var diagonals = [[],[]];
        // Check rows
        for(x = 0; x <this.boardState.length; x++) {
            var row = this.boardState[x];
            if (row[0] != 0 && row.isSingleValued()) {
                return true;
            }
        }

        // Check columns
        for(x = 0;x < globalUser.settings.grids;x++) {
            var col = this.boardState.map(function(value) { return value[x]; });
            if (col[0] != 0 && col.isSingleValued()) {
                return true;
            }
        }

        // Check diagonals
        for(x = 0;x < globalUser.settings.grids;x++) {
            for(y = 0;y < globalUser.settings.grids;y++) {
                if(x == y) {
                    diagonals[0].push(this.boardState[x][y]);
                    diagonals[1].push(this.boardState[globalUser.settings.grids - 1 - x][y]);
                }

            }
        }

        for(x = 0; x <diagonals.length; x++){
            var diagonal = diagonals[x];
            if (diagonal[0] != 0 && diagonal.isSingleValued()) {
                return true;
            }
        }
        return false;
    }
};

},{"../config":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/config.js","../entities/player":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/entities/player.js","../utils/utils":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/utils/utils.js"}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/gameOver.js":[function(require,module,exports){
/**
 * Created by saurabhk on 11/07/16.
 */
var GameOver = function () {
    this.text = null;
};

module.exports = GameOver;

GameOver.prototype = {

    create: function () {
        var x = this.game.width / 2;
        var y = this.game.height / 2;

        var style = {font: "65px Arial", fill: "#dddddd", align: "center"};

        this.text = this.add.text(x - 300, y - 200, "GameOver", style);

        this.input.onDown.add(this.onDown, this);
    },

    update: function () {
    },

    onDown: function () {
        this.game.state.start(playerState.currentLevel);
    }
};

},{}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/menu.js":[function(require,module,exports){
var Menu = function () {
    this.text = null;
};

module.exports = Menu;

Menu.prototype = {

    create: function () {
        var x = this.game.width / 2;
        var y = this.game.height / 2;

        var style = {font: "65px Arial", fill: "#dddddd", align: "center"};

        this.text = this.add.text(x - 300, y - 200, "Press to Start", style);

        this.input.onDown.add(this.onDown, this);
    },

    update: function () {
    },

    onDown: function () {
        this.game.state.start(playerState.currentLevel);
    }
};

},{}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/preloader.js":[function(require,module,exports){
var Preloader = function (game) {
    this.asset = null;
    this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

    preload: function () {
        this.asset = this.add.sprite(320, 240, 'preloader');
        this.asset.anchor.setTo(0.5, 0.5);

        this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
        this.load.setPreloadSprite(this.asset);
        this.load.image('testsprite', 'assets/test.png');
    },

    create: function () {
        this.asset.cropEnabled = false;
    },

    update: function () {
        if (!!this.ready) {
            this.game.state.start('Menu');
        }
    },

    onLoadComplete: function () {
        this.ready = true;
    }
};

},{}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/states/splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
    create: function () {
    }
};
},{}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/utils/prototype.js":[function(require,module,exports){
/**
 * Created by saurabhk on 10/07/16.
 */
(function(){
    Array.prototype.isSingleValued = function() {

        for(var i = 1; i < this.length; i++)
        {
            if(this[i] !== this[0])
                return false;
        }

        return true;
    }
})();
},{}],"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/utils/utils.js":[function(require,module,exports){
"use strict";
var config = require('./../config');
var Utils = {
    containsObject: function (obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    },

    gridSize: function(game) {
        var gameWidth =  Math.min(game.width, game.height) - 2 * config.graphicPadding;
        var gridTotalWidth = gameWidth - (globalUser.settings.grids - 1) * config.gameBoundaryWidth;
        return [gridTotalWidth / globalUser.settings.grids, gameWidth];
    }
};

module.exports = Utils;
},{"./../config":"/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/config.js"}]},{},["/Users/saurabhk/Workspace/Playground/Node Projects/phaser/tictactoe/src/js/main.js"])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvY29uZmlnLmpzIiwic3JjL2pzL2VudGl0aWVzL3BsYXllci5qcyIsInNyYy9qcy9tYWluLmpzIiwic3JjL2pzL3N0YXRlcy9ib290LmpzIiwic3JjL2pzL3N0YXRlcy9nYW1lLmpzIiwic3JjL2pzL3N0YXRlcy9nYW1lT3Zlci5qcyIsInNyYy9qcy9zdGF0ZXMvbWVudS5qcyIsInNyYy9qcy9zdGF0ZXMvcHJlbG9hZGVyLmpzIiwic3JjL2pzL3N0YXRlcy9zcGxhc2guanMiLCJzcmMvanMvdXRpbHMvcHJvdG90eXBlLmpzIiwic3JjL2pzL3V0aWxzL3V0aWxzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKipcbiAqIENyZWF0ZWQgYnkgc2F1cmFiaGsgb24gMTAvMDcvMTYuXG4gKi9cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGdyYXBoaWNQYWRkaW5nOiA1MCxcbiAgICBnYW1lQm91bmRhcnlXaWR0aDoxMFxufTsiLCJ2YXIgUGxheWVyID0gZnVuY3Rpb24gKGdhbWUsIHgsIHkpIHtcbiAgICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgJ3Rlc3RzcHJpdGUnKTtcbiAgICBnYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcbn07XG5cblBsYXllci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcblBsYXllci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQbGF5ZXI7XG5cbi8qKlxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXG4gKi9cblBsYXllci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQbGF5ZXI7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBnYW1lID0gbmV3IFBoYXNlci5HYW1lKDgwMCwgNjAwLCBQaGFzZXIuQVVUTywgJ3RpY3RhY3RvZS1nYW1lJyk7XG5cbndpbmRvdy5VdGlscyA9IHJlcXVpcmUoJy4vdXRpbHMvdXRpbHMnKTtcbnJlcXVpcmUoJy4vdXRpbHMvcHJvdG90eXBlJyk7XG53aW5kb3cucGxheWVyU3RhdGUgPSB7XG4gICAgY3VycmVudExldmVsOiAnR2FtZSdcbn07XG53aW5kb3cuZ2xvYmFsVXNlciA9IHt9O1xuZ2xvYmFsVXNlci5zZXR0aW5ncyA9IHtcbiAgICBncmlkczo0XG59O1xuXG5nYW1lLnN0YXRlLmFkZCgnQm9vdCcsIHJlcXVpcmUoJy4vc3RhdGVzL2Jvb3QnKSk7XG5nYW1lLnN0YXRlLmFkZCgnU3BsYXNoJywgcmVxdWlyZSgnLi9zdGF0ZXMvc3BsYXNoJykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ1ByZWxvYWRlcicsIHJlcXVpcmUoJy4vc3RhdGVzL3ByZWxvYWRlcicpKTtcbmdhbWUuc3RhdGUuYWRkKCdNZW51JywgcmVxdWlyZSgnLi9zdGF0ZXMvbWVudScpKTtcbmdhbWUuc3RhdGUuYWRkKCdHYW1lJywgcmVxdWlyZSgnLi9zdGF0ZXMvZ2FtZScpKTtcbmdhbWUuc3RhdGUuYWRkKCdHYW1lT3ZlcicsIHJlcXVpcmUoJy4vc3RhdGVzL2dhbWVPdmVyJykpO1xuXG5nYW1lLnN0YXRlLnN0YXJ0KCdCb290Jyk7XG4iLCJ2YXIgQm9vdCA9IGZ1bmN0aW9uICgpIHtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQm9vdDtcblxuQm9vdC5wcm90b3R5cGUgPSB7XG5cbiAgICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubG9hZC5pbWFnZSgncHJlbG9hZGVyJywgJ2Fzc2V0cy9wcmVsb2FkZXIuZ2lmJyk7XG4gICAgfSxcblxuICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmdhbWUuaW5wdXQubWF4UG9pbnRlcnMgPSAxO1xuICAgICAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gXCIjZmZmZmZmXCI7XG4gICAgICAgIGlmICh0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3ApIHtcbiAgICAgICAgICAgIHRoaXMuZ2FtZS5zdGFnZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5nYW1lLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XG4gICAgICAgICAgICB0aGlzLmdhbWUuc2NhbGUubWluV2lkdGggPSA0ODA7XG4gICAgICAgICAgICB0aGlzLmdhbWUuc2NhbGUubWluSGVpZ2h0ID0gMjYwO1xuICAgICAgICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heFdpZHRoID0gNjQwO1xuICAgICAgICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heEhlaWdodCA9IDQ4MDtcbiAgICAgICAgICAgIC8vdGhpcy5nYW1lLnNjYWxlLmZvcmNlTGFuZHNjYXBlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZ2FtZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5nYW1lLnNjYWxlLnVwZGF0ZUxheW91dCh0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnUHJlbG9hZGVyJyk7XG4gICAgfVxufTtcbiIsInZhciBQbGF5ZXIgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9wbGF5ZXInKTtcbnZhciBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcnKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzL3V0aWxzJyk7XG5cbnZhciBHYW1lID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMudGVzdGVudGl0eSA9IG51bGw7XG4gICAgdGhpcy5ncmFwaGljcyA9IG51bGw7XG4gICAgdGhpcy5zZWN0aW9uU2l6ZSA9IG51bGw7XG4gICAgdGhpcy50dXJuID0gdHJ1ZTtcbiAgICB0aGlzLmJvYXJkU3RhdGUgPSBbXTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZTtcblxuR2FtZS5wcm90b3R5cGUgPSB7XG5cbiAgICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGksajtcbiAgICAgICAgdmFyIGdyYXBoaWNzID0gdGhpcy5nYW1lLmFkZC5ncmFwaGljcyhjb25maWcuZ3JhcGhpY1BhZGRpbmcsIGNvbmZpZy5ncmFwaGljUGFkZGluZyk7XG4gICAgICAgIHRoaXMuZ3JhcGhpY3MgPSBncmFwaGljcztcblxuICAgICAgICAvLyBzZXQgYSBmaWxsIGFuZCBsaW5lIHN0eWxlXG4gICAgICAgIGdyYXBoaWNzLmxpbmVTdHlsZShjb25maWcuZ2FtZUJvdW5kYXJ5V2lkdGgsIDB4ZGRkZGRkKTtcbiAgICAgICAgdmFyIGdyaWREZXRhaWxzID0gdXRpbHMuZ3JpZFNpemUodGhpcy5nYW1lKTtcblxuICAgICAgICAvLyBWZXJ0aWNhbCBsaW5lc1xuICAgICAgICBmb3IgKGkgPSAxOyBpIDwgZ2xvYmFsVXNlci5zZXR0aW5ncy5ncmlkczsgaSsrKSB7XG4gICAgICAgICAgICBncmFwaGljcy5tb3ZlVG8oaSAqIGdyaWREZXRhaWxzWzBdICsgKGktMSkgKiBjb25maWcuZ2FtZUJvdW5kYXJ5V2lkdGgsMCk7XG4gICAgICAgICAgICBncmFwaGljcy5saW5lVG8oaSAqIGdyaWREZXRhaWxzWzBdICsgKGktMSkgKiBjb25maWcuZ2FtZUJvdW5kYXJ5V2lkdGgsIGdyaWREZXRhaWxzWzFdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEhvcml6b250YWwgbGluZXNcbiAgICAgICAgZm9yIChqID0gMTsgaiA8IGdsb2JhbFVzZXIuc2V0dGluZ3MuZ3JpZHM7IGorKykge1xuICAgICAgICAgICAgZ3JhcGhpY3MubW92ZVRvKDAsIGogKiBncmlkRGV0YWlsc1swXSArIChqLTEpICogY29uZmlnLmdhbWVCb3VuZGFyeVdpZHRoKTtcbiAgICAgICAgICAgIGdyYXBoaWNzLmxpbmVUbyhncmlkRGV0YWlsc1sxXSwgaiAqIGdyaWREZXRhaWxzWzBdICsgKGotMSkgKiBjb25maWcuZ2FtZUJvdW5kYXJ5V2lkdGgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2VjdGlvblNpemUgPSBncmlkRGV0YWlsc1sxXS9nbG9iYWxVc2VyLnNldHRpbmdzLmdyaWRzO1xuICAgICAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5hZGRQbGF5aW5nUGllY2UsIHRoaXMpO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgYm9hcmQgc3RhdGUgd2l0aCBhbGwgMCBieSBkZWZhdWx0XG4gICAgICAgIGZvcihpID0gMDsgaSA8IGdsb2JhbFVzZXIuc2V0dGluZ3MuZ3JpZHM7IGkrKykge1xuICAgICAgICAgICAgZm9yKGogPSAwOyBqIDwgZ2xvYmFsVXNlci5zZXR0aW5ncy5ncmlkczsgaisrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmRTdGF0ZVtpXSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkU3RhdGVbaV1bal0gPSAwXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFN0YXRlW2ldID0gW107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRTdGF0ZVtpXVtqXSA9IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgfSxcblxuICAgIG9uSW5wdXREb3duOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTWVudScpO1xuICAgIH0sXG5cbiAgICBhZGRQbGF5aW5nUGllY2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgeENvcmRpbmF0ZTtcbiAgICAgICAgdmFyIHlDb3JkaW5hdGU7XG4gICAgICAgIHZhciBzZWN0aW9uU2l6ZSA9IHRoaXMuc2VjdGlvblNpemU7XG4gICAgICAgIHZhciBtb3VzZSA9IHRoaXMuaW5wdXQucG9zaXRpb247XG4gICAgICAgIG1vdXNlLnggPSBtb3VzZS54IC0gY29uZmlnLmdyYXBoaWNQYWRkaW5nO1xuICAgICAgICBtb3VzZS55ID0gbW91c2UueSAtIGNvbmZpZy5ncmFwaGljUGFkZGluZztcblxuICAgICAgICBmb3IgKHZhciB4ID0gMDt4IDwgZ2xvYmFsVXNlci5zZXR0aW5ncy5ncmlkczt4KyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIHkgPSAwO3kgPCBnbG9iYWxVc2VyLnNldHRpbmdzLmdyaWRzO3krKykge1xuICAgICAgICAgICAgICAgIHhDb3JkaW5hdGUgPSB4ICogc2VjdGlvblNpemU7XG4gICAgICAgICAgICAgICAgeUNvcmRpbmF0ZSA9IHkgKiBzZWN0aW9uU2l6ZTtcblxuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgbW91c2UueCA+PSB4Q29yZGluYXRlICYmIG1vdXNlLnggPD0geENvcmRpbmF0ZSArIHNlY3Rpb25TaXplICYmXG4gICAgICAgICAgICAgICAgICAgIG1vdXNlLnkgPj0geUNvcmRpbmF0ZSAmJiBtb3VzZS55IDw9IHlDb3JkaW5hdGUgKyBzZWN0aW9uU2l6ZVxuICAgICAgICAgICAgICAgICAgICApIHtcblxuICAgICAgICAgICAgICAgICAgICAvL2NsZWFyUGxheWluZ0FyZWEoeENvcmRpbmF0ZSwgeUNvcmRpbmF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbFVzZXIudHVybiA9IFt5LHhdO1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmJvYXJkU3RhdGVbeV1beF0gPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudHVybikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhd1goeENvcmRpbmF0ZSwgeUNvcmRpbmF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFN0YXRlW3ldW3hdID0gXCJYXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhd08oeENvcmRpbmF0ZSwgeUNvcmRpbmF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFN0YXRlW3ldW3hdID0gXCJPXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR1cm4gPSAhdGhpcy50dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5pc1N0YXRlVGVybWluYWwoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydChcIkdhbWVPdmVyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZHJhd086IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICAgICAgdmFyIHNlY3Rpb25TaXplID0gdGhpcy5zZWN0aW9uU2l6ZTtcbiAgICAgICAgdmFyIGdyYXBoaWNzID0gdGhpcy5ncmFwaGljcztcbiAgICAgICAgdmFyIGhhbGZTZWN0aW9uU2l6ZSA9ICgwLjUgKiBzZWN0aW9uU2l6ZSk7XG4gICAgICAgIHZhciBjZW50ZXJYID0geCArIGhhbGZTZWN0aW9uU2l6ZTtcbiAgICAgICAgdmFyIGNlbnRlclkgPSB5ICsgaGFsZlNlY3Rpb25TaXplO1xuICAgICAgICB2YXIgZGlhbWV0ZXIgPSBzZWN0aW9uU2l6ZSAqIDAuNDtcbiAgICAgICAgICAgIGdyYXBoaWNzLmxpbmVTdHlsZSgxMCwgMHgwMWJCQzIpO1xuICAgICAgICAgICAgZ3JhcGhpY3MuZHJhd0NpcmNsZShjZW50ZXJYLCBjZW50ZXJZLCBkaWFtZXRlcik7XG5cbiAgICB9LFxuXG4gICAgZHJhd1g6IGZ1bmN0aW9uKHgseSkge1xuICAgICAgICB2YXIgZ3JhcGhpY3MgPSB0aGlzLmdyYXBoaWNzO1xuICAgICAgICB2YXIgc2VjdGlvblNpemUgPSB0aGlzLnNlY3Rpb25TaXplO1xuICAgICAgICBncmFwaGljcy5saW5lU3R5bGUoMTAsIDB4ZjFiZTMyKTtcbiAgICAgICAgdmFyIG9mZnNldCA9IHNlY3Rpb25TaXplICogMC4zO1xuICAgICAgICBncmFwaGljcy5tb3ZlVG8oeCArIG9mZnNldCwgeSArIG9mZnNldCk7XG4gICAgICAgIGdyYXBoaWNzLmxpbmVUbyh4ICsgc2VjdGlvblNpemUgLSBvZmZzZXQsIHkgKyBzZWN0aW9uU2l6ZSAtIG9mZnNldCk7XG5cbiAgICAgICAgZ3JhcGhpY3MubW92ZVRvKHggKyBvZmZzZXQsIHkgKyBzZWN0aW9uU2l6ZSAtIG9mZnNldCk7XG4gICAgICAgIGdyYXBoaWNzLmxpbmVUbyh4ICsgc2VjdGlvblNpemUgLSBvZmZzZXQsIHkgKyBvZmZzZXQpO1xuICAgIH0sXG5cbiAgICBpc1N0YXRlVGVybWluYWw6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgeCwgeTtcbiAgICAgICAgdmFyIGRpYWdvbmFscyA9IFtbXSxbXV07XG4gICAgICAgIC8vIENoZWNrIHJvd3NcbiAgICAgICAgZm9yKHggPSAwOyB4IDx0aGlzLmJvYXJkU3RhdGUubGVuZ3RoOyB4KyspIHtcbiAgICAgICAgICAgIHZhciByb3cgPSB0aGlzLmJvYXJkU3RhdGVbeF07XG4gICAgICAgICAgICBpZiAocm93WzBdICE9IDAgJiYgcm93LmlzU2luZ2xlVmFsdWVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGNvbHVtbnNcbiAgICAgICAgZm9yKHggPSAwO3ggPCBnbG9iYWxVc2VyLnNldHRpbmdzLmdyaWRzO3grKykge1xuICAgICAgICAgICAgdmFyIGNvbCA9IHRoaXMuYm9hcmRTdGF0ZS5tYXAoZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHZhbHVlW3hdOyB9KTtcbiAgICAgICAgICAgIGlmIChjb2xbMF0gIT0gMCAmJiBjb2wuaXNTaW5nbGVWYWx1ZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgZGlhZ29uYWxzXG4gICAgICAgIGZvcih4ID0gMDt4IDwgZ2xvYmFsVXNlci5zZXR0aW5ncy5ncmlkczt4KyspIHtcbiAgICAgICAgICAgIGZvcih5ID0gMDt5IDwgZ2xvYmFsVXNlci5zZXR0aW5ncy5ncmlkczt5KyspIHtcbiAgICAgICAgICAgICAgICBpZih4ID09IHkpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlhZ29uYWxzWzBdLnB1c2godGhpcy5ib2FyZFN0YXRlW3hdW3ldKTtcbiAgICAgICAgICAgICAgICAgICAgZGlhZ29uYWxzWzFdLnB1c2godGhpcy5ib2FyZFN0YXRlW2dsb2JhbFVzZXIuc2V0dGluZ3MuZ3JpZHMgLSAxIC0geF1beV0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yKHggPSAwOyB4IDxkaWFnb25hbHMubGVuZ3RoOyB4Kyspe1xuICAgICAgICAgICAgdmFyIGRpYWdvbmFsID0gZGlhZ29uYWxzW3hdO1xuICAgICAgICAgICAgaWYgKGRpYWdvbmFsWzBdICE9IDAgJiYgZGlhZ29uYWwuaXNTaW5nbGVWYWx1ZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59O1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHNhdXJhYmhrIG9uIDExLzA3LzE2LlxuICovXG52YXIgR2FtZU92ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy50ZXh0ID0gbnVsbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZU92ZXI7XG5cbkdhbWVPdmVyLnByb3RvdHlwZSA9IHtcblxuICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgeCA9IHRoaXMuZ2FtZS53aWR0aCAvIDI7XG4gICAgICAgIHZhciB5ID0gdGhpcy5nYW1lLmhlaWdodCAvIDI7XG5cbiAgICAgICAgdmFyIHN0eWxlID0ge2ZvbnQ6IFwiNjVweCBBcmlhbFwiLCBmaWxsOiBcIiNkZGRkZGRcIiwgYWxpZ246IFwiY2VudGVyXCJ9O1xuXG4gICAgICAgIHRoaXMudGV4dCA9IHRoaXMuYWRkLnRleHQoeCAtIDMwMCwgeSAtIDIwMCwgXCJHYW1lT3ZlclwiLCBzdHlsZSk7XG5cbiAgICAgICAgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMub25Eb3duLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgfSxcblxuICAgIG9uRG93bjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQocGxheWVyU3RhdGUuY3VycmVudExldmVsKTtcbiAgICB9XG59O1xuIiwidmFyIE1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy50ZXh0ID0gbnVsbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTWVudTtcblxuTWVudS5wcm90b3R5cGUgPSB7XG5cbiAgICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHggPSB0aGlzLmdhbWUud2lkdGggLyAyO1xuICAgICAgICB2YXIgeSA9IHRoaXMuZ2FtZS5oZWlnaHQgLyAyO1xuXG4gICAgICAgIHZhciBzdHlsZSA9IHtmb250OiBcIjY1cHggQXJpYWxcIiwgZmlsbDogXCIjZGRkZGRkXCIsIGFsaWduOiBcImNlbnRlclwifTtcblxuICAgICAgICB0aGlzLnRleHQgPSB0aGlzLmFkZC50ZXh0KHggLSAzMDAsIHkgLSAyMDAsIFwiUHJlc3MgdG8gU3RhcnRcIiwgc3R5bGUpO1xuXG4gICAgICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uRG93biwgdGhpcyk7XG4gICAgfSxcblxuICAgIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIH0sXG5cbiAgICBvbkRvd246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KHBsYXllclN0YXRlLmN1cnJlbnRMZXZlbCk7XG4gICAgfVxufTtcbiIsInZhciBQcmVsb2FkZXIgPSBmdW5jdGlvbiAoZ2FtZSkge1xuICAgIHRoaXMuYXNzZXQgPSBudWxsO1xuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUHJlbG9hZGVyO1xuXG5QcmVsb2FkZXIucHJvdG90eXBlID0ge1xuXG4gICAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFzc2V0ID0gdGhpcy5hZGQuc3ByaXRlKDMyMCwgMjQwLCAncHJlbG9hZGVyJyk7XG4gICAgICAgIHRoaXMuYXNzZXQuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcblxuICAgICAgICB0aGlzLmxvYWQub25Mb2FkQ29tcGxldGUuYWRkT25jZSh0aGlzLm9uTG9hZENvbXBsZXRlLCB0aGlzKTtcbiAgICAgICAgdGhpcy5sb2FkLnNldFByZWxvYWRTcHJpdGUodGhpcy5hc3NldCk7XG4gICAgICAgIHRoaXMubG9hZC5pbWFnZSgndGVzdHNwcml0ZScsICdhc3NldHMvdGVzdC5wbmcnKTtcbiAgICB9LFxuXG4gICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYXNzZXQuY3JvcEVuYWJsZWQgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghIXRoaXMucmVhZHkpIHtcbiAgICAgICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTWVudScpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uTG9hZENvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmVhZHkgPSB0cnVlO1xuICAgIH1cbn07XG4iLCJ2YXIgU3BsYXNoID0gZnVuY3Rpb24gKCkge1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTcGxhc2g7XG5cblNwbGFzaC5wcm90b3R5cGUgPSB7XG4gICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgfVxufTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgc2F1cmFiaGsgb24gMTAvMDcvMTYuXG4gKi9cbihmdW5jdGlvbigpe1xuICAgIEFycmF5LnByb3RvdHlwZS5pc1NpbmdsZVZhbHVlZCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGZvcih2YXIgaSA9IDE7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZih0aGlzW2ldICE9PSB0aGlzWzBdKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn0pKCk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgY29uZmlnID0gcmVxdWlyZSgnLi8uLi9jb25maWcnKTtcbnZhciBVdGlscyA9IHtcbiAgICBjb250YWluc09iamVjdDogZnVuY3Rpb24gKG9iaiwgbGlzdCkge1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChsaXN0W2ldID09PSBvYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LFxuXG4gICAgZ3JpZFNpemU6IGZ1bmN0aW9uKGdhbWUpIHtcbiAgICAgICAgdmFyIGdhbWVXaWR0aCA9ICBNYXRoLm1pbihnYW1lLndpZHRoLCBnYW1lLmhlaWdodCkgLSAyICogY29uZmlnLmdyYXBoaWNQYWRkaW5nO1xuICAgICAgICB2YXIgZ3JpZFRvdGFsV2lkdGggPSBnYW1lV2lkdGggLSAoZ2xvYmFsVXNlci5zZXR0aW5ncy5ncmlkcyAtIDEpICogY29uZmlnLmdhbWVCb3VuZGFyeVdpZHRoO1xuICAgICAgICByZXR1cm4gW2dyaWRUb3RhbFdpZHRoIC8gZ2xvYmFsVXNlci5zZXR0aW5ncy5ncmlkcywgZ2FtZVdpZHRoXTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFV0aWxzOyJdfQ==
